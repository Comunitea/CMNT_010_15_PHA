<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <record id="custom_views_clear_invoice_mandate_form" model="ir.ui.view">
            <field name="name">Custom views - Invoice form, clear mandate button</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="account_banking_mandate.invoice_form"/>
            <field name="priority">15</field>
            <field name="arch" type="xml">
                <field name="mandate_id" position="replace">
                    <group colspan="2" col="3">
                        <field name="mandate_id"
                               domain="[('partner_id', '=', commercial_partner_id), ('state', '=', 'valid')]"
                               attrs="{'invisible': [('type', '=', 'out_refund')]}"/>
                        <button name="clear_mandate" icon="gtk-clear"
                                type="object" class="oe_edit_only"
                                attrs="{'invisible': [('state', 'in', ('draft', 'cancel'))]}"/>
                    </group>
                </field>
            </field>
        </record>

        <record id="custom_views_invoice_form" model="ir.ui.view">
            <field name="name">Custom views - Invoice form</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="account.invoice_form"/>
            <field name="priority">16</field>
            <field name="arch" type="xml">
                <field name="payment_term" position="replace"></field>
                <field name="payment_mode_id" position="after">
                    <field name="payment_term"
                           class="oe_inline"
                           on_change="onchange_payment_term_date_invoice(payment_term, date_invoice)"
                           modifiers="{'readonly': [['state', 'not in', ['draft']]]}"/>
                    <field name="banking_mandate_needed" invisible="1"/>
                </field>
                <field name="mandate_id" position="attributes">
                    <attribute name="attrs">{'required': [('banking_mandate_needed', '=', True)]}</attribute>
                    <attribute name="domain">['|',('partner_id.child_ids','in',[partner_id]),('partner_id','=',partner_id),('state','=','valid')]</attribute>
                </field>
                <field name="move_id" position="after">
                    <field name="payment_document_delivered"/>
                    <field name="commercial_partner_id"
                           string="Invoicing address"
                           readonly="0"/>
                    <field name="partner_shipping_id"
                           string="Shipping address"
                           readonly="0"/>
                </field>
                <field name="partner_id" position="after">
                    <field name="partner_liens" invisible="1"/>
                    <field name="partner_vat_liens" style="color: red;" attrs="{'invisible': [('partner_liens', '=', False)]}"/>
                    <field name="partner_vat" attrs="{'invisible': [('partner_liens', '=', True)]}"/>
                </field>
                <field name="state" position="before">
                    <button name="duplicate"
                            type="object"
                            icon="gtk-copy"
                            string="Duplicar"
                            confirm="Â¿Desea duplicar esta factura?"
                            groups="custom_views.group_duplicate_button_invoice"
                            class="oe_read_only"
                    />
                </field>
            </field>
        </record>

        <record id="custom_views_invoice_supplier_form" model="ir.ui.view">
            <field name="name">Custom views - Invoice supplier form</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="account.invoice_supplier_form" />
            <field name="arch" type="xml">
                <field name="payment_term" position="replace"></field>
                <field name="payment_mode_id" position="after">
                    <field name="payment_term"
                           class="oe_inline"
                           on_change="onchange_payment_term_date_invoice(payment_term, date_invoice)"
                           modifiers="{'readonly': [['state', 'not in', ['draft']]]}"/>
                </field>
                <tree string="Invoice lines" position="inside">
                    <field name="invoice_type" invisible="1"/>
                </tree>
                <field name="analytics_id" position="attributes">
                    <attribute name="attrs">{'required': [('invoice_type', '=', 'in_invoice')]}</attribute>
                </field>
                <field name="move_id" position="after">
                    <field name="payment_document_delivered"/>
                </field>
                <field name="partner_id" position="after">
                    <field name="partner_liens" invisible="1"/>
                    <field name="partner_vat_liens" style="color: red;" attrs="{'invisible': [('partner_liens', '=', False)]}"/>
                    <field name="partner_vat" attrs="{'invisible': [('partner_liens', '=', True)]}"/>
                </field>
            </field>
        </record>

        <record id="custom_views_invoice_tree" model="ir.ui.view">
            <field name="name">Custom views - Invoice tree</field>
            <field name="model">account.invoice</field>
            <field name="inherit_id" ref="account.invoice_tree" />
            <field name="arch" type="xml">
                <field name="partner_id" position="after">
                    <field name="partner_shipping_id" groups="base.group_user"/>
                    <field name="reference" invisible="context.get('journal_type') == 'sale'"/>
                    <field name="supplier_invoice_number" invisible="context.get('journal_type') == 'sale'"/>
                    <field name="type"/>
                </field>
                <field name="agent_code" position="attributes">
                    <attribute name="invisible">1</attribute>
                </field>
                <field name="state" position="after">
                    <field name="payment_document_date"/>
                </field>
            </field>
        </record>
    </data>
</openerp>