<?xml version="1.0" encoding="utf-8"?>
<openerp>
<data>

    <!-- Vista qweb de prueba que lista los productos a consumir de una produccion -->
    <template id="stock_move_mrp_consume" name="Moves to consume">
        <div class="wrap">
            <div class="container">
                <div class="row">
                    <table class="table table-hover">
                        <thead>
                            <tr>
                                <th>Fecha:</th>
                            </tr>
                            <tr>
                                <th>Material</th>
                                <th>Lote</th>
                                <th>Fecha aceptado por C.Calidad</th>
                                <th>Cantidad a servir</th>
                                <th>Cantidad servida</th>
                                <th>Iniciales</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr t-foreach="production.move_lines" t-as="move">
                                <td><span t-field='move.product_id.name' /></td>
                                <td><span t-if='move.reserved_quant_ids and move.reserved_quant_ids[0].lot_id' t-field='move.reserved_quant_ids[0].lot_id.name' /></td>
                                <td></td>
                                <td><span t-field='move.product_qty'/> <span t-field='move.product_uom.name'/></td>
                                <td></td>
                                <td></td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </template>

    <!-- Vista de prueba usada como cabecera del protocolo de produccion -->
    <template id="production_header" name="Production header">
        <div class="wrap">
            <div class="container">
                <div class="row">
                   <div>
                        <p>PRODUCTO: </p><span t-field='production.product_id.name' />
                        <p>LOTE: </p><span t-if='production.final_lot_id' t-field='production.final_lot_id.name' />
                   </div>
                </div>
            </div>
        </div>
    </template>

    <!-- Vista generica de impresion de surveys -->
    <template id="generic_survey" name="Production header">
        <div class="wrap">
            <div class="container">
                <div class="row">
                    <form role="form" method="post" class="js_surveyform" t-att-name="'%s' % (survey.id)" t-att-data-prefill="'/survey/prefill/%s/%s' % (slug(survey), token)" t-att-data-scores="'/survey/scores/%s/%s' % (slug(survey), token) if quizz_correction else ''">
                        <t t-foreach="survey.page_ids" t-as="page">
                            <div class="page-header">
                                <h1 t-field='page.title' />
                                <t t-if="page.description"><div t-field='page.description' class="oe_no_empty"/></t>
                            </div>
                            <t t-foreach='page.question_ids' t-as='question'>
                                <t t-set="prefix" t-value="'%s_%s_%s' % (survey.id, page.id, question.id)" />
                                <div class="js_question-wrapper" t-att-id="prefix">
                                    <h2>
                                        <span t-field='question.question' />
                                        <span t-if="question.constr_mandatory" class="text-danger">*</span>
                                        <span t-if="quizz_correction" class="badge" t-att-data-score-question="question.id"></span>
                                    </h2>
                                    <t t-if="question.description"><div class="text-muted oe_no_empty" t-field='question.description'/></t>
                                    <t t-if="question.type == 'free_text'"><t t-call="survey.free_text"/></t>
                                    <t t-if="question.type == 'textbox'"><t t-call="survey.textbox"/></t>
                                    <t t-if="question.type == 'numerical_box'"><t t-call="survey.numerical_box"/></t>
                                    <t t-if="question.type == 'datetime'"><t t-call="survey.datetime"/></t>
                                    <t t-if="question.type == 'simple_choice'"><t t-call="survey.simple_choice"/></t>
                                    <t t-if="question.type == 'multiple_choice'"><t t-call="survey.multiple_choice"/></t>
                                    <t t-if="question.type == 'matrix'"><t t-call="survey.matrix"/></t>
                                    <div class="js_errzone alert alert-danger" style="display:none;"></div>
                                </div>
                            </t>
                        </t>
                    </form>
                </div>
            </div>
        </div>
    </template>

    <!-- Vista contenedora para el prototipo, se debe mirar como se puede generar al vuelo, desde el controller -->
    <template id="protocol_print" name="Protocol">
        <t t-call="website.layout">
            <div class="wrap">
                <div class="container">
                    <div class="row">
                        <t t-call="quality_protocol_report.production_header"/> <!-- Muestra la vista qweb de cabecera -->
                        <t t-call="quality_protocol_report.stock_move_mrp_consume"/> <!-- Muestra la vista qweb de movimientos a consumir de una produccion -->
                        <t t-call="quality_protocol_report.generic_survey"> <!-- Muestra la vista genÃ©rica de surveys, instanciando survey abajo, con la variable pasada en contexto del controller survey1 -->
                            <t t-set="survey" t-value="survey1"/> <!-- El valor de survey1 se enlaza a survey para que se pueda utilizar survey en la vista generica -->
                        </t>
                    </div>
                </div>
            </div>
        </t>
    </template>

</data>
</openerp>
